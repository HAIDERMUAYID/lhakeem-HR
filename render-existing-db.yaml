# Render Blueprint – استخدام قاعدة بيانات موجودة
# استخدم هذا الملف إذا كان لديك بالفعل PostgreSQL على Render ومربوط بالنظام.
# في لوحة Render: New → Blueprint → اختر هذا الملف أو أنشئ الخدمتين يدوياً واربط DATABASE_URL بقاعدتك.

services:
  - type: web
    name: alhakeem-api
    runtime: node
    rootDir: backend
    buildCommand: npm install --include=dev && npx prisma generate && npm run build
    startCommand: npx prisma migrate deploy && npm run start:prod
    envVars:
      - key: DATABASE_URL
        sync: false   # ضعه يدوياً من قاعدة البيانات الموجودة (Internal Database URL)
      - key: JWT_SECRET
        generateValue: true
      - key: NODE_ENV
        value: production
      - key: WEB_URL
        sync: false   # ضعه يدوياً، مثال: https://alhakeem-web.onrender.com (لـ CORS)

  - type: web
    name: alhakeem-web
    runtime: node
    rootDir: frontend
    buildCommand: npm install && npm run build
    startCommand: npm run start
    envVars:
      - key: NEXT_PUBLIC_API_URL
        sync: false   # ضعه يدوياً بعد نشر الـ API (رابط alhakeem-api)
